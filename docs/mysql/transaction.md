# MySQL 事务

## 数据库中的事务是什么？

事务 (transaction) 是作为一个单元的一组有序的数据库操作。

如果组中的所有操作都成功，则认为事务成功，即使只有一个操作失败，事务也不成功。

如果所有操作完成，事务则提交，其修改将作用于所有其他数据库进程。如果一个操作失败，则事务将回滚，该事务所有操作的影响都将取消。

## 事务的特性有哪些？

ACID。

1. 原子性 (Atomicity)：即不可分割性，事务要么全部被执行，要么就全部不被执行。
2. 一致性 (Consistency)：事务的执行使得数据库从一种正确状态转换成另一种正确状态
3. 隔离性 (Isolation)：在事务正确提交之前，不允许把该事务对数据的任何改变提供给任何其他事务，
4. 持久性 (Durability)：事务正确提交后，其结果将永久保存在数据库中，即使在事务提交后有了其他故障，事务的处理结果也会得到保存。

## MySQL 有哪些事务隔离级别

|                  | 隔离级别 | 脏读 | 不可重复读 | 幻读 |
| ---------------- | -------- | ---- | ---------- | ---- |
| READ UNCOMMITTED | 读未提交 | ✔    | ✔          | ✔    |
| READ COMMITTED   | 读提交   | ❌   | ✔          | ✔    |
| REPEATABLE READ  | 重复读   | ❌   | ❌         | ✔    |
| SERIALIZABLE     | 序列化   | ❌   | ❌         | ❌   |

1. InnoDB 存储引擎默认支持的隔离级别是 REPEATABLE READ，但是与标准 SQL 不同的是，InnoDB 存储引擎在 REPEATABLE READ 事务隔离级别下，使用 Next-Key Lock 锁的算法，因此避免幻读的产生。
2. 隔离级别越低，事务请求的锁越少或保持锁的时间越短。所以大多数数据库系统默认的事务隔离级别是 READ COMMITTED。
